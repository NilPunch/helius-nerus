using UnityEngine;

public class PlayersCreator : MonoBehaviour
{
    [SerializeField] private Player[] _playerShips = null;
    private Player _currentPlayer = null;
    private int _currentPlayerIndex = -1;

    public static PlayersCreator Instance
    {
        get;
        private set;
    } = null;

    private void Awake()
    {
        Instance = this;
        ChangePlayer();
    }

    public void ChangePlayer(bool next = true)
    {
        if (next)
        {
            _currentPlayerIndex++;
            if (_currentPlayerIndex >= _playerShips.Length)
                _currentPlayerIndex = 0;
        }
        else
        {
            _currentPlayerIndex--;
            if (_currentPlayerIndex < 0)
            {
                _currentPlayerIndex = _playerShips.Length - 1;
            }
        }

        //if (_currentPlayer != null)
        //    Destroy(_currentPlayer);

        _currentPlayer = Instantiate(_playerShips[_currentPlayerIndex]);
        _currentPlayer.IsNotMoving = true;
        _currentPlayer.IsNotShooting = true;
        _currentPlayer.RestartPlayer();

        Player.ShipNumber = _currentPlayerIndex;
    }

    public void LoadPlayerFromSave(int shipNumber)
    {
        _currentPlayerIndex = shipNumber - 1;
        ChangePlayer();
    }

#if UNITY_EDITOR
    private void Update()
    {
        if (Input.GetKeyDown(KeyCode.RightArrow))
        {
            ChangePlayer();
        }
    }
#endif
}
